USE COMERCIO;


SELECT NOMBRE, MARCA, PRECIO, 
CASE MARCA
	WHEN 'LEVIS' THEN 'OFERTA'
    WHEN 'ROXY' THEN '2X1'
    WHEN 'RUSTY' THEN 'AHORA 12'
    ELSE 'PROMO'
END AS MENSAJE
FROM PRODUCTOS;

/*
PRECIO < 10000		'ENVIO 24HR'
PRECIO 10000-25000	'ENVIO GRATIS'
PRECIO > 25000		'ENVIAMOS UNA GIFT CARD'
*/

SELECT NOMBRE, MARCA, PRECIO, 
CASE 
	WHEN PRECIO < 10000 THEN 'ENVIO 24HR'
    WHEN PRECIO BETWEEN 10000 AND 25000 THEN 'ENVIO GRATIS'
    WHEN PRECIO > 25000 THEN 'GIFT CARD DE REGALO'
    ELSE 'SIN PROMO'
END AS MENSAJE
FROM PRODUCTOS;


SELECT NOMBRE, MARCA, PRECIO, TALLE
FROM PRODUCTOS
ORDER BY 
CASE TALLE 
	WHEN 'XS' THEN 1
    WHEN 'S' THEN 2
    WHEN 'M' THEN 3
    WHEN 'L' THEN 4
    WHEN 'XL' THEN 5
    WHEN 'XXL' THEN 6
    ELSE 99
END ;

--------------------

SELECT * 
FROM PRODUCTOS
WHERE ID_PRODUCTO = 10;

BEGIN;
	UPDATE PRODUCTOS
    SET TALLE = 'AA'
    WHERE ID_PRODUCTO = 10;
    
    SELECT * 
FROM PRODUCTOS
WHERE ID_PRODUCTO = 10;
ROLLBACK;

--------------------------------------------
--------------------------------------------
/*
SUB CONSULTAS

- SC EN EL WHERE 
- SC EN EL SELECT
- SC EN EL FROM
*/

/*
	SC EN EL WHERE:
    - MOSTRAR PRODUCTOS QUE TENGAN UN PRECIO MAYOR A EL PROMEDIO
*/

SELECT AVG(PRECIO) FROM PRODUCTOS;

SELECT * FROM PRODUCTOS WHERE PRECIO > 18114;

SELECT * FROM PRODUCTOS WHERE PRECIO > (SELECT AVG(PRECIO) FROM PRODUCTOS);

-- MOSTRAR LOS PRODUCTOS QUE TENGAN EL PRECIO MINMO

-- MIN(PRECIO)

SELECT MIN(PRECIO) FROM PRODUCTOS;

SELECT * FROM PRODUCTOS WHERE PRECIO = (SELECT MIN(PRECIO) FROM PRODUCTOS);

-- SC EN EL WHERE (IN )

-- MOSTRAR LAS FACTURAS QUE SE HICIERON A CLIENTES QUE TIENEN CORREO DE GMAIL.

SELECT ID_CLIENTE FROM CLIENTES WHERE MAIL LIKE '%GMAIL.COM%';

SELECT * FROM FACTURAS WHERE ID_CLIENTE IN (SELECT ID_CLIENTE FROM CLIENTES WHERE MAIL LIKE '%GMAIL.COM%');

-------------------------------------------------------

-- SUB CONSULTAS EN EL SELECT -- SC CORRELACIONADAS

SELECT NOMBRE, PRECIO, PRECIO * 1.21
FROM PRODUCTOS;

-- MOSTRAR ID, NOMBRE, PRECIO, MARCA, CANTIDAD VENDIDA

SELECT SUM(CANTIDAD) FROM FACTURAS WHERE FACTURAS.ID_PRODUCTO = 1;


SELECT ID_PRODUCTO, NOMBRE, PRECIO, MARCA, 
	(SELECT SUM(CANTIDAD) FROM FACTURAS WHERE FACTURAS.ID_PRODUCTO = PRODUCTOS.ID_PRODUCTO) AS CANTIDAD_VENDIDA
FROM PRODUCTOS;